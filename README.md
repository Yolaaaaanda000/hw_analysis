# 自动作业分析（Student Homework Analysis）

本项目为一款基于HTML+JS的作业成绩分析工具，支持上传CSV/Excel文件，自动生成学生分数表、错题统计、错题分布图等，适用于老师和教研人员进行作业数据分析。

## 主要功能
- 支持上传CSV、Excel（.xlsx/.xls）作业成绩文件
- 自动识别学生姓名、题号、分数等信息
- 分数表支持“题号为行，学生为列”转置显示
- 每题显示题号、题目内容、标签、错题人数，每个学生的得分
- 支持批量编辑题号标签
- 错题人数单元格颜色与错题分布柱状图颜色规则一致
- 每列宽度可自定义，字号美观统一
- 支持输入作业标题，自动从文件名中提取并填充
- 可一键保存分数表或完整分析报告为图片，图片带白边和作业标题
- 分数表底部自动统计每个学生的错题数量

## 使用方法
1. 打开 `hw_analysis.html` 文件（推荐使用Chrome浏览器）
2. 点击“选择文件”，上传作业成绩的CSV或Excel文件
3. 文件名如 `323821081_按分数_25Summer-AMC10B-HW02_8_8.xlsx`，会自动提取 `25Summer-AMC10B-HW02` 作为作业标题
4. 可手动修改作业标题，或批量编辑题号标签
   用中括号表示原始作业文档的名称，题号可以用逗号,隔开，可以用1-9表示第1到第九题
    例：
        [AMC10-9] 1-7,9,10
    显示：
        题号：1,2,3,4,5,6,7,9,10
        标签：[AMC10-9]
5. 点击“Analyze”按钮，自动生成分析结果
6. 可点击“仅保存分数图片”或“Save Full Report”按钮，将分析结果保存为图片

## 依赖说明
- 本工具为纯前端HTML+JS，无需后端环境
- 依赖以下CDN库：
  - [xlsx.js](https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js)（Excel解析）
  - [Chart.js](https://cdn.jsdelivr.net/npm/chart.js)（错题分布图）
  - [html2canvas](https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js)（保存图片）
  - [chartjs-plugin-datalabels](https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels)

## 主要特性说明
- **分数表转置**：题号为行，学生为列，便于横向对比
- **错题人数配色**：错题率>0.5为红色，0.25~0.5为黄色，0~0.25为蓝绿色，0为白色
- **宽度与字号**：各列宽度、内容字号、标题字号均可自定义，默认美观适中
- **作业标题自动识别**：自动从文件名第二个_到倒数第二个_之间提取标题
- **图片导出**：导出图片带白边，标题居中，适合打印或分享

## 文件说明
- `hw_analysis.html`：主分析页面，包含全部功能

## 常见问题
- 建议使用Chrome浏览器，部分老旧浏览器可能不兼容
- Excel文件需为标准表格格式，首行为表头
- 若遇到图片保存不全，可适当放大浏览器窗口再保存

---
如有问题或建议，欢迎联系开发者。 
